<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <process id="repair" name="repairProcess" isExecutable="true">
    <startEvent id="startevent1" name="Start"></startEvent>
    <endEvent id="endevent1" name="End"></endEvent>
    <userTask id="applyTask" name="报修申请单" activiti:assignee="${inputUser}">
      <extensionElements>
        <activiti:formProperty id="repairId" name="表单ID" type="string" required="true"></activiti:formProperty>
      </extensionElements>
    </userTask>
    <userTask id="checkTask" name="设备检测" activiti:assignee="${inputUser}"></userTask>
    <sequenceFlow id="flow1" sourceRef="startevent1" targetRef="applyTask"></sequenceFlow>
    <sequenceFlow id="flow2" sourceRef="applyTask" targetRef="checkTask"></sequenceFlow>
    <userTask id="serviceTask" name="服务台" activiti:assignee="${inputUser}"></userTask>
    <userTask id="servicePd" name="服务商派单" activiti:assignee="${inputUser}"></userTask>
    <userTask id="normalRepairTask" name="正常维修" activiti:assignee="${inputUser}"></userTask>
    <sequenceFlow id="flow9" sourceRef="normalRepairTask" targetRef="endevent1"></sequenceFlow>
    <userTask id="systemToService" name="平台派单中标商" activiti:assignee="${inputUser}"></userTask>
    <userTask id="zxRepair" name="自行维修" activiti:assignee="${inputUser}"></userTask>
    <userTask id="saveRecord" name="记录考核" activiti:assignee="${inputUser}"></userTask>
    <sequenceFlow id="flow12" sourceRef="zxRepair" targetRef="saveRecord"></sequenceFlow>
    <sequenceFlow id="flow13" sourceRef="saveRecord" targetRef="endevent1"></sequenceFlow>
    <exclusiveGateway id="isFinish" name="是否自行维修"></exclusiveGateway>
    <sequenceFlow id="flow15" sourceRef="checkTask" targetRef="isFinish"></sequenceFlow>
    <sequenceFlow id="flow16" name="是" sourceRef="isFinish" targetRef="zxRepair">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${isFinish == 0}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow17" name="否" sourceRef="isFinish" targetRef="serviceTask">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${isFinish == 1}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="localService" name="本地服务商" activiti:assignee="${inputUser}"></userTask>
    <userTask id="belongService" name="自有工程师" activiti:assignee="${inputUser}"></userTask>
    <userTask id="tjService" name="提交厂商" activiti:assignee="${inputUser}"></userTask>
    <userTask id="homeService" name="上门服务" activiti:assignee="${inputUser}"></userTask>
    <sequenceFlow id="flow26" sourceRef="homeService" targetRef="normalRepairTask"></sequenceFlow>
    <exclusiveGateway id="repairType" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow28" sourceRef="serviceTask" targetRef="repairType"></sequenceFlow>
    <sequenceFlow id="flow29" name="保外" sourceRef="repairType" targetRef="servicePd">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${repairType == 0}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow30" name="保内" sourceRef="repairType" targetRef="systemToService">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${repairType == 1}]]></conditionExpression>
    </sequenceFlow>
    <exclusiveGateway id="exclusivegateway1" name="Exclusive Gateway"></exclusiveGateway>
    <sequenceFlow id="flow31" sourceRef="systemToService" targetRef="exclusivegateway1"></sequenceFlow>
    <sequenceFlow id="flow32" name="委托" sourceRef="exclusivegateway1" targetRef="localService">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${cstype == 0}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow33" name="自修" sourceRef="exclusivegateway1" targetRef="belongService">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${cstype == 1}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow34" name="原厂" sourceRef="exclusivegateway1" targetRef="tjService">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${cstype == 2}]]></conditionExpression>
    </sequenceFlow>
    <userTask id="qdService" name="抢单池" activiti:assignee="${inputUser}"></userTask>
    <sequenceFlow id="flow35" sourceRef="servicePd" targetRef="qdService"></sequenceFlow>
    <sequenceFlow id="flow36" sourceRef="qdService" targetRef="localService"></sequenceFlow>
    <sequenceFlow id="flow38" sourceRef="belongService" targetRef="homeService"></sequenceFlow>
    <sequenceFlow id="flow39" sourceRef="localService" targetRef="homeService"></sequenceFlow>
    <sequenceFlow id="flow40" sourceRef="tjService" targetRef="homeService"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_repair">
    <bpmndi:BPMNPlane bpmnElement="repair" id="BPMNPlane_repair">
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="20.0" y="30.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent1" id="BPMNShape_endevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="433.0" y="500.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="applyTask" id="BPMNShape_applyTask">
        <omgdc:Bounds height="55.0" width="105.0" x="100.0" y="20.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="checkTask" id="BPMNShape_checkTask">
        <omgdc:Bounds height="55.0" width="105.0" x="260.0" y="20.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="serviceTask" id="BPMNShape_serviceTask">
        <omgdc:Bounds height="55.0" width="105.0" x="580.0" y="20.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="servicePd" id="BPMNShape_servicePd">
        <omgdc:Bounds height="55.0" width="105.0" x="580.0" y="220.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="normalRepairTask" id="BPMNShape_normalRepairTask">
        <omgdc:Bounds height="55.0" width="105.0" x="578.0" y="490.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="systemToService" id="BPMNShape_systemToService">
        <omgdc:Bounds height="55.0" width="105.0" x="877.0" y="220.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="zxRepair" id="BPMNShape_zxRepair">
        <omgdc:Bounds height="55.0" width="105.0" x="398.0" y="161.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="saveRecord" id="BPMNShape_saveRecord">
        <omgdc:Bounds height="55.0" width="105.0" x="398.0" y="303.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="isFinish" id="BPMNShape_isFinish">
        <omgdc:Bounds height="40.0" width="40.0" x="430.0" y="27.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="localService" id="BPMNShape_localService">
        <omgdc:Bounds height="55.0" width="105.0" x="736.0" y="382.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="belongService" id="BPMNShape_belongService">
        <omgdc:Bounds height="55.0" width="105.0" x="877.0" y="382.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="tjService" id="BPMNShape_tjService">
        <omgdc:Bounds height="55.0" width="105.0" x="1010.0" y="382.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="homeService" id="BPMNShape_homeService">
        <omgdc:Bounds height="55.0" width="105.0" x="877.0" y="490.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="repairType" id="BPMNShape_repairType">
        <omgdc:Bounds height="40.0" width="40.0" x="612.0" y="121.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="909.0" y="310.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="qdService" id="BPMNShape_qdService">
        <omgdc:Bounds height="55.0" width="105.0" x="580.0" y="321.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flow1" id="BPMNEdge_flow1">
        <omgdi:waypoint x="55.0" y="47.0"></omgdi:waypoint>
        <omgdi:waypoint x="100.0" y="47.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow2" id="BPMNEdge_flow2">
        <omgdi:waypoint x="205.0" y="47.0"></omgdi:waypoint>
        <omgdi:waypoint x="260.0" y="47.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow9" id="BPMNEdge_flow9">
        <omgdi:waypoint x="578.0" y="517.0"></omgdi:waypoint>
        <omgdi:waypoint x="468.0" y="517.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow12" id="BPMNEdge_flow12">
        <omgdi:waypoint x="450.0" y="216.0"></omgdi:waypoint>
        <omgdi:waypoint x="450.0" y="303.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow13" id="BPMNEdge_flow13">
        <omgdi:waypoint x="450.0" y="358.0"></omgdi:waypoint>
        <omgdi:waypoint x="450.0" y="500.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow15" id="BPMNEdge_flow15">
        <omgdi:waypoint x="365.0" y="47.0"></omgdi:waypoint>
        <omgdi:waypoint x="430.0" y="47.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow16" id="BPMNEdge_flow16">
        <omgdi:waypoint x="450.0" y="67.0"></omgdi:waypoint>
        <omgdi:waypoint x="450.0" y="161.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="12.0" x="459.0" y="99.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow17" id="BPMNEdge_flow17">
        <omgdi:waypoint x="470.0" y="47.0"></omgdi:waypoint>
        <omgdi:waypoint x="580.0" y="47.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="12.0" x="519.0" y="27.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow26" id="BPMNEdge_flow26">
        <omgdi:waypoint x="877.0" y="517.0"></omgdi:waypoint>
        <omgdi:waypoint x="683.0" y="517.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow28" id="BPMNEdge_flow28">
        <omgdi:waypoint x="632.0" y="75.0"></omgdi:waypoint>
        <omgdi:waypoint x="632.0" y="121.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow29" id="BPMNEdge_flow29">
        <omgdi:waypoint x="632.0" y="161.0"></omgdi:waypoint>
        <omgdi:waypoint x="632.0" y="220.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="24.0" x="600.0" y="173.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow30" id="BPMNEdge_flow30">
        <omgdi:waypoint x="652.0" y="141.0"></omgdi:waypoint>
        <omgdi:waypoint x="929.0" y="141.0"></omgdi:waypoint>
        <omgdi:waypoint x="929.0" y="220.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="24.0" x="759.0" y="121.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow31" id="BPMNEdge_flow31">
        <omgdi:waypoint x="929.0" y="275.0"></omgdi:waypoint>
        <omgdi:waypoint x="929.0" y="310.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow32" id="BPMNEdge_flow32">
        <omgdi:waypoint x="909.0" y="330.0"></omgdi:waypoint>
        <omgdi:waypoint x="788.0" y="329.0"></omgdi:waypoint>
        <omgdi:waypoint x="788.0" y="382.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="24.0" x="818.0" y="308.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow33" id="BPMNEdge_flow33">
        <omgdi:waypoint x="929.0" y="350.0"></omgdi:waypoint>
        <omgdi:waypoint x="929.0" y="382.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="24.0" x="890.0" y="352.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow34" id="BPMNEdge_flow34">
        <omgdi:waypoint x="949.0" y="330.0"></omgdi:waypoint>
        <omgdi:waypoint x="1062.0" y="329.0"></omgdi:waypoint>
        <omgdi:waypoint x="1062.0" y="382.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="14.0" width="24.0" x="1009.0" y="308.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow35" id="BPMNEdge_flow35">
        <omgdi:waypoint x="632.0" y="275.0"></omgdi:waypoint>
        <omgdi:waypoint x="632.0" y="321.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow36" id="BPMNEdge_flow36">
        <omgdi:waypoint x="632.0" y="376.0"></omgdi:waypoint>
        <omgdi:waypoint x="632.0" y="410.0"></omgdi:waypoint>
        <omgdi:waypoint x="736.0" y="409.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow38" id="BPMNEdge_flow38">
        <omgdi:waypoint x="929.0" y="437.0"></omgdi:waypoint>
        <omgdi:waypoint x="929.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow39" id="BPMNEdge_flow39">
        <omgdi:waypoint x="788.0" y="437.0"></omgdi:waypoint>
        <omgdi:waypoint x="788.0" y="461.0"></omgdi:waypoint>
        <omgdi:waypoint x="928.0" y="461.0"></omgdi:waypoint>
        <omgdi:waypoint x="928.0" y="476.0"></omgdi:waypoint>
        <omgdi:waypoint x="929.0" y="490.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow40" id="BPMNEdge_flow40">
        <omgdi:waypoint x="1062.0" y="437.0"></omgdi:waypoint>
        <omgdi:waypoint x="1062.0" y="517.0"></omgdi:waypoint>
        <omgdi:waypoint x="982.0" y="517.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>